/*
** EPITECH PROJECT, 2021
** Untitled (Workspace)
** File description:
** verify_move_by_something.c
*/
#include "my_rpg.h"

const int *TAB_PASSAGE_HELP[] = {
(int[]){581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
581, 581, 581, -1, -1, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
581, 581, 581, 581, -1, -1, -1, -1, 581, 581, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
581, 581, 581, -1, -1, -1, 581, 581, 581, 581, -1, 581, -1, -1, -1, -1, -1, -1,
-1, -1, -1, -1, -1, -1, 581, 581, -100},
(int[]){581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, 581, 581, 581, 581, 581, 581, -1, 581, 581, 581, 581, 581, 581, 581, -1,
-1, -1, -1, -1, -1, 581, 581, -100},
(int[]){581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, 581, 581, 581, 581, 581, 581, -1, -1, -1, -1, 581, 581, 581, 581, -1, -1,
-1, -1, -1, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, 581, 581, 581, 581, 581, 581, -1, -1, -1, -1, 581, 581, 581, 581, -1, -1,
-1, 581, 581, 581, 581, 581, -100},
(int[]){581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, 581, 581, 581, 581, 581, 581, -1, -1, -1, -1, 581, 581, 581, 581, -1, -1,
-1, -1, -1, 581, 581, 581, -100},
(int[]){581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
581, 581, 581, 581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, 581, 581, 581, -100},
(int[]){581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
581, 581, 581, 581, 581, -1, -1, 581, 581, -1, 581, -1, -1, -1, -1, -1, -1, -1,
581, 581, 581, 581, 581, -100},
(int[]){581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
581, 581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581,
581, 581, 581, 581, 581, -100},
(int[]){581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
581, 581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581,
581, 581, 581, 581, 581, -100},
(int[]){581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581,
581, 581, 581, 581, 581, 581, -1, -1, -1, -1, 581, 581, 581, -1, -1, -1, -1,
-1, 581, 581, 581, 581, 581, -100},
(int[]){581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581,
581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
581, 581, 581, 581, 581, -100},
(int[]){581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581,
581, 581, 581, 581, 581, -1, -1, 581, 581, -1, -1, 581, -1, -1, -1, -1, -1, -1,
581, 581, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581,
581, 581, 581, 581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, -1, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581,
581, 581, 581, 581, 581, 581, 581, -1, -1, 581, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, -1, -1, -1, 581, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, 581,
581, 581, 581, 581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, -1, -1, -1, -1, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, 581, -1, -1, -1, -1, -1, -1, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, -1, -1, -1, -1, -1, -1, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, 581, -1, -1, -1, -1, -1, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, -1,
581, 581, 581, 581, 581, 581, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, 581, 581, -1, 581, 581, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
-1, 581, 581, 581, 581, 581, 581, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, 581, 581, -1, 581, 581, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
-1, 581, 581, 581, 581, 581, 581, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, 581, 581, -1, 581, 581, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
-1, 581, 581, 581, 581, 581, 581, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, 581, 581, -1, 581, 581, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
-1, 581, 581, 581, 581, 581, 581, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, 581, -1, -1, -1, -1, 581, 581, 581,
581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, 581, 581, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, 581, -1, -1, -1, -1, 581, 581, 581,
-1, -1, -1, -1, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581, -1, -1, -1, -1,
-1, 581, 581, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, 581, -1, -1, -1, -1, -1, 581, 581,
-1, 581, 581, 581, -1, -1, -1, 581, 581, -1, -1, 581, -1, -1, -1, -1, -1, 581,
581, -1, 581, 581, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581, 581, -1,
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, -1, 581, -100},
(int[]){581, 581, 581, 581, -1, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581, 581, 581, -1,
-1, -1, 581, -1, 581, -100},
(int[]){581, 581, 581, 581, -1, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581, 581, 581,
581, -1, -1, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581, 581, 581, 581,
581, 581, -1, -1, 581, -100},
(int[]){581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, -1, -1, -1, -1, -1, -1, -1, 581, -1, -1, -1, -1, 581, 581, -1, -1, -1,
581, 581, -1, 581, -100},
(int[]){581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, -1, -1, -1, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581,
581, 581, -1, 581, -100},
(int[]){581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1,
-1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581, 581, 581,
581, -1, -1, 581, -100},
(int[]){581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581, 581,
581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581, 581, -1, -1, -1,
-1, 581, 581, -1, 581, -100},
(int[]){581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581, 581,
581, 581, 581, 581, 581, -1, -1, -1, -1, -1, 581, 581, 581, -1, -1, 581, -1,
581, -1, 581, -1, -1, 581, -100},
(int[]){581, 581, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 581, 581,
581, 581, 581, 581, 581, -1, -1, -1, -1, 581, 581, 581, -1, -1, -1, 581, 581,
-1, -1, 581, 581, -1, 581, -100},
(int[]){581, 581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, -1, 581, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, -1, -1, -1,
-1, -1, -1, -1, -1, -1, -1, 581, -100},
(int[]){581, 581, 581, 581, 581, -1, -1, -1, -1, -1, -1, -1, 581, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, -100},
(int[]){581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581, 581,
581, 581, 581, 581, 581, 581, 581, 581, 581, 581, -100},
NULL};

int is_too_far(info_game_t *info_, player_t **perso, float x, float y)
{
    (void)info_;
    if (!((*perso)->my_sprite->position.x + x >= 0 &&
        (*perso)->my_sprite->position.y + y >= 0)) {
        return (1);
    }
    return (0);
}

int return_edge_of_player_x(player_t **perso, float x, float y)
{
    if (y != 0) {
        return ((*perso)->my_sprite->len.x / 2);
    } else {
        if (x >= 0) {
            return ((*perso)->my_sprite->len.x + x);
        } else
            return (x);
    }
    return (x);
}

int return_edge_of_player_y(player_t **perso, float x, float y)
{
    if (x != 0) {
        return ((*perso)->my_sprite->len.y / 2);
    } else {
        if (y >= 0) {
            return ((*perso)->my_sprite->len.y + y);
        } else
            return ((*perso)->my_sprite->len.y / 2 + y);
    }
    return (0);
}

int move_in_pnj(info_game_t *info_, float x, float y)
{
    for (int i = 0; info_->game.pnj[i]; i++) {
        sfFloatRect rect1 =
        sfSprite_getGlobalBounds(info_->game.pnj[i]->my_sprite->sprite);
        sfFloatRect rect2 =
        sfSprite_getGlobalBounds(info_->game.perso->my_sprite->sprite);
        rect2.top += y;
        rect2.left += x;
        if (info_->game.pnj[i]->my_sprite->type.open == sfTrue &&
        sfFloatRect_intersects(&rect1, &rect2, NULL)) {
            return (1);
        }
    }
    return (0);
}

int move_by_something(info_game_t *info_, player_t **perso, float x, float y)
{
    int val_x = 0;
    int val_y = 0;

    if (move_in_pnj(info_, x, y)) {
        return (1);
    }
    val_x += (int)(((*perso)->my_sprite->position.x +
    return_edge_of_player_x(perso, x, y)) / 32);
    val_y += (int)(((*perso)->my_sprite->position.y +
    return_edge_of_player_y(perso, x, y)) / 32);
    if (is_too_far(info_, perso, x, y) ||
    TAB_PASSAGE_HELP[val_y][val_x] == 581) {
        return (1);
    }
    return (0);
}
